# 嵌入式系統期末專案
嵌入式系統設計期末專案 — 01157034 陳尚洋

## 簡介
- 本專案以 ESP32 與 8051 微控制器 為核心，結合 Adafruit IO 與 IoT MQTT Panel 雲端平台，實現一個可同時透過實體裝置與網路操作的多功能互動系統。
- 整個系統具備顯示、聲音輸出、網路同步與計時控制等功能，並可隨時切換 6 種模式，展現出軟硬體整合、IoT 應用與人機互動的能力。

## 功能

### 模式一：溫度顯示模式
- 使用 8051 上的 矩陣鍵盤 切換顯示六都（台北、新北、桃園、台中、台南、高雄）的即時溫度。
- ESP32 取得氣象資料後透過 UART 傳送給 8051，顯示於七段顯示器。
- 按下特定鍵可顯示當下全台最高溫城市。

### 模式二：音階控制模式
- 透過 MQTT Dashboard 發送指令控制 8051 發出對應音階（Do、Re、Mi…）。
- 可即時用手機或電腦操作，讓 8051 產生不同音效。

### 模式三：編曲模式
- 使用 MQTT 或輸入數字及符號「.」來編輯旋律。
- ESP32 接收到樂譜資料後轉發給 8051，由蜂鳴器演奏音樂。
- 支援簡單的「數字樂譜」編曲方式。

### 模式四：鍵盤同步模式
- 在 Adafruit IO Dashboard 上的控制元件可對應 8051 的矩陣鍵盤操作。
- 使用者可透過雲端介面遠端操作，8051 會同步反應，顯示溫度或觸發動作。

### 模式五：時區時間顯示模式
- 使用 MQTT 輸入指定時區，ESP32 會透過API取得對應時間資料。
- 8051 接收後可顯示當前時區時間，並可應用於提醒或同步顯示。

### 模式六：倒數計時器模式
- ESP32 接收秒數設定，8051 執行倒數計時。
- 在最後 10 秒，每秒會發出提示聲，計時結束後連續響聲。
- 支援透過 MQTT 遠端控制：
  * ON → 開始/繼續
  * OFF → 暫停
  * +XXXX → 增加秒數（上限 9999 秒）
  * -XXXX → 減少秒數（下限 0 秒）

## 成果展示影片
- 影片展示連結：https://youtu.be/mwNtMpFFtp8

## 程式碼說明影片
- 程式碼說明連結：https://youtu.be/jp4NtFyL4dk

## 如何使用
### 工具 
- ESP32、8051 
- 手機安裝 IoT MQTT Panel 
- 設定好 Adafruit IO 與 OpenWeatherMap 所需的 API key，以及 Wi-Fi 帳號密碼 
- 在 Adafruit 上建立所需的 feeds 

### 步驟說明 
1. 使用 Keil uVision ，將 `Final_01157034.c` 編譯為 HEX 檔 
2. 使用 STC-ISP v6.91M ，將 HEX 檔燒錄至 8051 開發板 
3. 使用 Thonny 將 `final.py` 上傳並執行於 ESP32 
4. 使用 IoT MQTT panel 傳送指令至 ESP32
5. 開始使用各種功能

### 可輸入的指令
- 切換模式：
  * modeX 如：mode1, mode5
- 模式一：
  * (無MQTT輸入，使用8051矩陣鍵盤)
- 模式二：
  * 音名如：C4, D5
- 模式三：
  * 一段任意長度的數字1~8和小數點如：123.456.78.
- 模式四：
  * 鍵盤數字與符號如：1, 5, #, *
- 模式五：
  * 時區如：TPE, 巴黎, tokyo, los angeles
- 模式六：
  * ON → 開始/繼續
  * OFF → 暫停
  * +XXXX → 增加秒數（上限 9999 秒）
  * -XXXX → 減少秒數（下限 0 秒）
